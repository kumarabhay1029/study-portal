rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Notes uploads - allow authenticated users to upload PDFs under 10MB
    match /notes/{fileName} {
      allow read: if true; // Public read for approved notes
      allow create: if request.auth != null
        && resource == null
        && request.resource.size < 10 * 1024 * 1024  // 10MB limit
        && request.resource.contentType == 'application/pdf'
        && fileName.matches('.*\\.pdf$');
      
      allow delete: if request.auth != null; // Allow cleanup by authenticated users
    }
  }
}
